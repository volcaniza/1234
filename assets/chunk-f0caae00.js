var T=Object.defineProperty;var j=(e,t,n)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var y=(e,t,n)=>(j(e,typeof t!="symbol"?t+"":t,n),n);const C="dpfkgaedamhcmkkgeiajeggihmfjhhlj",Q="1.8.1",Z="https://chathub.aipilot.cc/",ee="https://chromewebstore.google.com/detail/dpfkgaedamhcmkkgeiajeggihmfjhhlj",te="https://microsoftedge.microsoft.com/addons/detail/simple-chat-hub/plaobjkecadfmaglmhdaolohmckjgnom",ne="https://github.com/jackyr/simple-chat-hub-extension/issues",oe="https://github.com/jackyr/simple-chat-hub-extension?tab=readme-ov-file#donors",se="https://chathub.aipilot.cc/api",re=500,ie=10,ce=6,ae=5e3,le=15,he=12096e5,de=3,ue={clientId:"clientId",appInfo:"appInfo",options:"options",promptOptimizationUsage:"promptOptimizationUsage",feedbackRecord:"feedbackRecord",promptLibrary:"promptLibrary"};var m=(e=>(e.System="system",e.Light="light",e.Dark="dark",e))(m||{}),S=(e=>(e.System="system",e.English="en",e.Chinese_Simplified="zh-CN",e.Chinese_Traditional="zh-TW",e.Spanish="es",e.Arabic="ar",e.Russian="ru",e.French="fr",e.Germany="de",e.Portuguese_Portugal="pt-PT",e.Portuguese_Brazil="pt-BR",e.Japanese="ja",e.Korean="ko",e))(S||{}),p=(e=>(e.JPEG="image/jpeg",e.PNG="image/png",e))(p||{});const fe={chatAppIdGroups:[],colMaxCount:0,themeMode:"system",language:"system",primaryColor:"#1677ff"},me=[["ChatGPT"],["Gemini"],["Claude"]],ge=[["Kimi"],["DeepSeek"],["DouBao"]];var O=(e=>(e.LoadFailed="loadFailed",e.Timeout="timeout",e.SendFailed="sendFailed",e.Unknown="unknown",e))(O||{});function pe(e){const t=(n,o,s)=>{if(typeof n=="object"&&n!==null&&n.source===C)return e(n.action,n.data,s)};return chrome.runtime.onMessage.addListener(t),t}function we(e){chrome.runtime.onMessage.removeListener(e)}function Ee(...e){return chrome.runtime.sendMessage({action:e[0],data:e[1],source:C})}async function be(...e){const[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});if(t.id)return chrome.tabs.sendMessage(t.id,{action:e[0],data:e[1],source:C})}const D=.7,A=.8,_=.2,W=.3,F=1.5,U=.7,B=.05;function G(e){if(e.length===0)return null;const t={width:window.innerWidth,height:window.innerHeight},n=new WeakMap;e.forEach(r=>n.set(r,r.getBoundingClientRect()));let o=e.map(r=>{const i=n.get(r),h=N(r,i,t),d=z(i,t);return{element:r,score:h,rect:i,position:d,adjustedScore:0}});o.sort((r,i)=>i.score-r.score);const s=o.filter(r=>r.position==="center"||r.position==="full"),a=o.filter(r=>r.position==="left"||r.position==="right");o.forEach(r=>{r.adjustedScore=V(r,t,s,a)}),o.sort((r,i)=>i.adjustedScore-r.adjustedScore);let c=o[0];for(let r=1;r<o.length;r++){const i=o[r];if(H(i.element,c.element))k(i,c)&&(c=i);else if(H(c.element,i.element))k(c,i)||(c=i);else break}return c.element}function N(e,t,n){const o=t.width*t.height/(n.width*n.height),s=n.width/2,a=n.height/2,r=1-Math.sqrt(Math.pow(t.left+t.width/2-s,2)+Math.pow(t.top+t.height/2-a,2))/Math.sqrt(s*s+a*a),i=e.innerText.length/1e3,h=(Math.min(t.right,n.width)-Math.max(t.left,0))*(Math.min(t.bottom,n.height)-Math.max(t.top,0))/(n.width*n.height),d=e.scrollHeight,u=e.clientHeight,f=d>u?(d-u)/n.height:0;return o*.25+r*.2+i*.2+h*.15+f*.2}function z(e,t){const n=t.width/2;t.height/2;const o=e.left+e.width/2;return e.width>t.width*D&&e.height>t.height*A?"full":Math.abs(o-n)<t.width*_?"center":o<n?"left":"right"}function V(e,t,n,o){let s=e.score;const a=e.rect.width/t.width;a>.6&&(s*=1.8),(e.position==="center"||e.position==="full")&&(s*=1.5),a<.25&&(s*=.5);const c=e.rect.width/e.rect.height;c>.5&&c<2&&(s*=1.2),n.includes(e)&&(s*=1.2),o.includes(e)&&(s*=.9);const r=window.getComputedStyle(e.element);return(r.overflowY==="scroll"||r.overflowY==="auto")&&(s*=1.1),e.rect.height/t.height>.7&&(s*=1.3),e.element.scrollHeight/e.element.clientHeight>1.5&&(s*=1.2),s}function k(e,t){const o=(t.adjustedScore-e.adjustedScore)/t.adjustedScore;if(o>W)return!1;const s=e.element.scrollHeight/e.element.clientHeight,a=t.element.scrollHeight/t.element.clientHeight;if(s>a*F)return!0;const c=window.innerWidth*window.innerHeight,r=e.rect.width*e.rect.height,i=t.rect.width*t.rect.height,h=Math.abs(r-c),d=Math.abs(i-c);return h<d*U||o<B}function H(e,t){let n=e.parentElement;for(;n!=null;){if(n==t)return!0;n=n.parentElement}return!1}function ye(){return Math.random().toString(36).substring(2,7)}function M(e){return new Promise(t=>{setTimeout(t,e)})}function Se(){const e=navigator.userAgent.toLowerCase();return e.includes("edg")?"Edge":e.includes("chrome")&&!e.includes("edg")?"Chrome":e.includes("firefox")?"Firefox":e.includes("safari")&&!e.includes("chrome")?"Safari":"Other"}function Re(){const e=Object.values(S),t=chrome.i18n.getUILanguage();if(e.includes(t))return t;const n=t.slice(0,2);return e.includes(n)?n:S.English}function Ce(e){const t=window.matchMedia("(prefers-color-scheme: dark)");return e&&t.addEventListener("change",n=>{n.matches?e(m.Dark):e(m.Light)}),t.matches?m.Dark:m.Light}function xe(e){const t=e.split("/");return t.length===1&&t.unshift(""),{name:t[1].trim(),company:t[0].trim(),handle:n=>n(t[0].trim(),t[1].trim())}}function ve(e,t){const n=[t||document.body];for(;n.length>0;){const o=n.pop();if(o.shadowRoot){const a=o.shadowRoot.querySelector(e);if(a)return a;const c=Array.from(o.shadowRoot.children);n.push(...c)}const s=Array.from(o.children);n.push(...s)}return null}function Y(e=":not(script,noscript)",t=document.body){let n=[];return n=Array.from(t.querySelectorAll(e)),n.forEach(o=>{o.shadowRoot&&(n=n.concat(Y(e,o.shadowRoot)))}),n}function ke(){const e=Array.from(document.querySelectorAll("*")).filter(t=>{if(t instanceof HTMLElement){const n=window.getComputedStyle(t);if(n.getPropertyValue("display")!=="none"&&n.getPropertyValue("visibility")!=="hidden"&&parseFloat(n.getPropertyValue("opacity"))>0){const o=n.getPropertyValue("overflow-y");return o==="auto"||o==="scroll"}}return!1});return e.length>1?G(e)||document.documentElement:e.length===1?e[0]:document.documentElement}function He(e){for(var t=e.parentElement;t;){var n=window.getComputedStyle(t).getPropertyValue("position");if(n==="relative"||n==="absolute"||n==="fixed"||n==="sticky")return t;t=t.parentElement}return document.body}function Ie(e,t,n){const o=e;if(o.focus(),n==="pasta"){const s=new DataTransfer;s.setData("text/plain",t);const a=new ClipboardEvent("paste",{clipboardData:s,bubbles:!0});o.dispatchEvent(a)}else if(n==="text"){o.innerText=t;const s=new Event("input",{bubbles:!0});o.dispatchEvent(s)}else{o.value=t;const s=new Event("input",{bubbles:!0});o.dispatchEvent(s)}}async function Le(e,t){const n=e;if(await M(300),t==="click"||t==="mousedown"){const o=new MouseEvent(t,{bubbles:!0,cancelable:!0});n.dispatchEvent(o)}else{n.focus();const o=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",which:13,keyCode:13,bubbles:!0,cancelable:!0});n.dispatchEvent(o)}}class q{constructor(){y(this,"events");y(this,"errorListeners");this.events={},this.errorListeners=[]}triggerErrorListener(t,n){this.errorListeners.length||console.error(`Error in listener of event "${t}":`,n),this.errorListeners.forEach(o=>{try{o(t,n)}catch{}})}on(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}once(t,n){const o=(...s)=>{try{n(...s)}catch(a){this.triggerErrorListener(t,a)}finally{this.off(t,o)}};this.on(t,o)}emit(t,...n){this.events[t]&&this.events[t].slice().forEach(o=>{try{o(...n)}catch(s){this.triggerErrorListener(t,s)}})}off(t,n){if(this.events[t]){const o=this.events[t].indexOf(n);o!==-1&&this.events[t].splice(o,1)}}onError(t){this.errorListeners.push(t)}}const I=new q,w=p.JPEG,E=.7,X=2,g=2;let R=!1;function L(){R=!0}function l(e){return Math.ceil(e*window.devicePixelRatio)}function K(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top,pageX:t.left+window.scrollX,pageY:t.top+window.scrollY,width:t.width,height:t.height,scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}function J(e=w){return chrome.tabs.captureVisibleTab({format:e.split("/")[1],quality:E*100})}async function Me(e,t=w){const n=K(e),o=document.createElement("canvas");o.width=l(n.width),o.height=l(n.height);const s=o.getContext("2d"),a=await J(p.PNG),c=new Image;return c.src=a,await new Promise(r=>c.onload=r),s.drawImage(c,l(n.pageX),l(n.pageY),o.width,o.height,0,0,o.width,o.height),new Promise(r=>{o.toBlob(i=>{r(i)},t,E)})}function Pe(e,t,n){const o=document.createElement("canvas"),s=o.getContext("2d");o.width=l(e.scrollWidth),o.height=l(e.scrollHeight);let a=0,c=0;return R=!1,I.off("interruptCapture",L),I.on("interruptCapture",L),new Promise((r,i)=>{async function h(){for(;a<e.scrollHeight;){for(;c<e.scrollWidth;){if(R)return i(new Error("Manual interrupted"));const{left:d,top:u}=await n({left:c,top:a});await M(1e3/X);const f=await t(),b=new Image;b.src=URL.createObjectURL(f),await new Promise(P=>b.onload=P);const x=Math.min(l(e.clientWidth+g),o.width-l(c)),v=Math.min(l(e.clientHeight+g),o.height-l(a));s.drawImage(b,l(e.pageX+(c-d)),l(e.pageY+(a-u)),x,v,l(c),l(a),x,v),c+=e.clientWidth-g}c=0,a+=e.clientHeight-g}o.toBlob(d=>{r(d)},p.PNG)}h()})}async function Te(e,{title:t="",logoName:n="",logoUrl:o="",bannerHeight:s=l(64),logoPadding:a=l(50),logoSize:c=l(24)}){const r=document.createElement("canvas"),i=r.getContext("2d"),h=new Image;h.src=typeof e=="string"?e:URL.createObjectURL(e),await new Promise(u=>h.onload=u),r.width=h.width,r.height=h.height+s,i.fillStyle="#fff",i.fillRect(0,0,r.width,s),i.font=`${l(18)}px Arial`,i.fillStyle="#333",i.textAlign="center",i.textBaseline="middle",i.fillText(t,r.width/2,s/2+l(1));const d=new Image;return d.src=o,await new Promise(u=>d.onload=u),i.drawImage(d,a,s/2-c/2,c,c),i.font=`bold ${l(16)}px Arial`,i.textAlign="left",i.fillText(n,c+a+l(8),s/2+l(2)),i.drawImage(h,0,s),new Promise(u=>{r.toBlob(f=>{u(f)},w,E)})}function je(e){typeof e=="string"?window.open().document.write('<img src="'+e+'" alt="screenshot" />'):e instanceof Blob?window.open(URL.createObjectURL(e),"_blank"):e.toBlob(t=>{window.open(URL.createObjectURL(t),"_blank")},w,E)}export{O as A,xe as B,I as C,we as D,ae as E,be as F,Pe as G,Me as H,Te as I,je as J,Ce as K,S as L,fe as M,Re as N,ge as O,me as P,p as S,m as T,pe as a,ke as b,Y as c,M as d,He as e,Ie as f,K as g,ue as h,se as i,oe as j,ye as k,Se as l,Q as m,te as n,ee as o,ne as p,ve as q,Z as r,Ee as s,Le as t,ie as u,re as v,de as w,he as x,le as y,ce as z};
